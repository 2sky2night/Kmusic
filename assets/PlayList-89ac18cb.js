import{r as B,u as H,e as M,_ as W,a as S,b as Y}from"./index-1f548d76.js";import{u as Z,o as G,a as J}from"./vue-router-70c59f8f.js";import{P as K}from"./pubsub-js-4eb33f76.js";import{o as Q,X as ee,e as ae}from"./@vicons-ed1f5506.js";import{d as j,o as n,c as _,V as l,W as g,a as r,X as U,e as z,U as C,$ as b,F as x,a3 as I,Y as te,Z as se,a1 as q,S as F,r as h,I as oe,w as $,g as ne}from"./@vue-923429e4.js";import{j as le,N as L,E as re,d as ue,h as ce,F as ie}from"./naive-ui-809e5fbb.js";import{_ as R}from"./vue-img-cutter-7be274e5.js";import"./pinia-6f3a18e1.js";import"./vue-demi-71ba0ef2.js";import"./pinia-plugin-persistedstate-4f3b1591.js";import"./axios-760d4776.js";import"./nprogress-93825526.js";import"./artplayer-dacbf558.js";/* empty css               */import"./vueuc-f6692277.js";import"./evtd-b614532e.js";import"./seemly-d1bbd19f.js";import"./@css-render-39cdbd82.js";import"./vooks-13ee1ac7.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-c742445b.js";import"./treemate-25c27bff.js";import"./date-fns-975a2d8f.js";const pe=()=>B.get("/playlist/catlist"),ge=(a,v,u=20)=>B.get("/top/playlist",{params:{cat:a,limit:u,offset:(v-1)*u}}),_e=a=>(te("data-v-2fe71d7b"),a=a(),se(),a),de={class:"category-panel"},me=_e(()=>r("span",{style:{"margin-right":"10px"}},"歌单分类",-1)),ye={class:"first-category"},ve={class:"second-category"},fe=j({__name:"CategoryPanel",props:{tags:null,currentTag:null},emits:["closePanel","chooseCategory"],setup(a,{emit:v}){function u(){v("closePanel")}function i(o){v("chooseCategory",o),u()}return(o,c)=>{const m=le,y=L,k=re;return n(),_("div",de,[l(k,{class:"title"},{default:g(()=>[r("div",null,[me,l(m,{onClick:c[0]||(c[0]=()=>i(a.tags.all.name)),class:U(`tag ${a.currentTag===a.tags.all.name?"tag-active":""}`),bordered:!1},{default:g(()=>[z(C(a.tags.all.name),1)]),_:1},8,["class"])]),l(y,{size:"30",style:{cursor:"pointer"},onClick:u},{default:g(()=>[l(b(Q))]),_:1})]),_:1}),r("ul",ye,[(n(!0),_(x,null,I(Object.keys(a.tags.categoryName),d=>(n(),_("li",{key:d},[r("div",null,[r("span",null,C(a.tags.categoryName[d]),1),z(">")]),r("ul",ve,[(n(!0),_(x,null,I(a.tags.categories[d],p=>(n(),_("li",{key:p.name},[l(m,{class:U(`tag ${a.currentTag===p.name?"tag-active":""}`),bordered:!1,onClick:()=>i(p.name)},{default:g(()=>[p.hot?(n(),q(y,{key:0,color:"red",style:{position:"relative",top:"2px"}},{default:g(()=>[l(b(ee))]),_:1})):F("",!0),r("span",null,C(p.name),1)]),_:2},1032,["class","onClick"])]))),128))])]))),128))])])}}});const he=R(fe,[["__scopeId","data-v-2fe71d7b"]]),Ce={class:"discover-playlist"},ke={class:"tags-btn"},Pe={style:{"font-size":"13px"}},be={class:"music-list"},we={key:1},$e=["onClick"],xe={key:2,class:"pagination"},Ie=j({__name:"PlayList",setup(a){const v=H(),u=Z(),i=J(),o=h(i.query.tag?i.query.tag:"全部歌单"),c=h(i.query.page?M(+i.query.page):1),m=h(!1);let y={};const k=h(0),d=oe([]),p=h(!0),P=h(12),V=[{label:"12 每页",value:12},{label:"24 每页",value:24},{label:"36 每页",value:36},{label:"48 每页",value:48}];async function D(){try{const e=await pe();e.code!==200&&await Promise.reject(),y.categories=e.sub.reduce((t,f)=>(Object.keys(t).includes(""+f.category)||Reflect.set(t,f.category,[]),t[f.category].push(f),t),{}),y.categoryName=e.categories,y.all=e.all}catch{S("获取歌单分类失败 🤐","error")}}function T(){m.value=!m.value}function E(e){o.value=e}async function w(){p.value=!0,d.splice(0,d.length);try{const e=await ge(o.value,c.value,P.value);e.code!==200&&await Promise.reject(),e.playlists.forEach(t=>{d.push(t)}),k.value=e.total,p.value=!1}catch{S(`获取 ${o.value} 分类的歌单失败 😪`,"warning")}}function O(e){e!==v.userData.id?u.push(`/user/${e}`):u.push("/my")}return $(o,e=>{c.value=1,u.push({path:i.path,query:{tag:e,page:1}})}),$(c,e=>{u.push({path:i.path,query:{tag:o.value,page:e}})}),$(P,()=>{if(c.value===1){K.publish("to-top"),w();return}c.value=1,u.push({path:i.path,query:{tag:o.value,page:1}})}),G(e=>{c.value=e.query.page?+e.query.page:1,o.value=e.query.tag?e.query.tag:"全部歌单",w()}),ne(async()=>{await D(),await w()}),(e,t)=>{const f=L,N=ue,X=ce,A=ie;return n(),_("div",Ce,[r("div",ke,[l(N,{onClick:T,togglePanel:"",strong:"",secondary:"",style:{"border-radius":"20px"}},{default:g(()=>[r("span",Pe,C(o.value),1),l(f,null,{default:g(()=>[l(b(ae))]),_:1})]),_:1}),l(X,{show:m.value,"onUpdate:show":t[0]||(t[0]=s=>m.value=s)},{default:g(()=>[l(he,{currentTag:o.value,tags:b(y),onClosePanel:T,onChooseCategory:E},null,8,["currentTag","tags"])]),_:1},8,["show"])]),r("div",be,[p.value?(n(),q(W,{key:0,length:P.value,coverRadius:10,textCenter:!1},null,8,["length"])):(n(),_("ul",we,[(n(!0),_(x,null,I(d,s=>(n(),q(Y,{key:s.id,coverImgUrl:s.coverImgUrl,id:s.id,name:s.name,playCount:s.playCount},{default:g(()=>[r("span",{class:"user",onClick:()=>O(s.userId)},C(s.creator.nickname),9,$e)]),_:2},1032,["coverImgUrl","id","name","playCount"]))),128))])),p.value?F("",!0):(n(),_("div",xe,[l(A,{"page-slot":6,"page-size":P.value,"onUpdate:pageSize":t[1]||(t[1]=s=>P.value=s),page:c.value,"onUpdate:page":t[2]||(t[2]=s=>c.value=s),"item-count":k.value,"page-sizes":V,"show-size-picker":""},{prefix:g(()=>[r("span",null,"共 "+C(k.value)+" 项",1)]),_:1},8,["page-size","page","item-count"])]))])])}}});const ea=R(Ie,[["__scopeId","data-v-8c7764cd"]]);export{ea as default};
