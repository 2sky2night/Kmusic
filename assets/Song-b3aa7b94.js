import{x as W,_ as ne,u as ie,P as ae,a as x,y as A,b as le,i as re}from"./index-1f548d76.js";import{d as M,o as i,c as _,a as t,V as e,W as p,a4 as P,U as w,e as C,$ as I,r as $,I as H,g as ce,w as ue,a1 as y,F as T,a3 as V,S as F,Y as _e,Z as pe}from"./@vue-923429e4.js";import{g as de,a as me,b as ge}from"./index-a4f649f6.js";import{u as Y,o as ve,d as fe,a as he}from"./vue-router-70c59f8f.js";import{b as ye,V as ke,T as Se}from"./@vicons-ed1f5506.js";import{_ as Z,N as q,v as xe,w as Ce,d as $e,h as we}from"./naive-ui-809e5fbb.js";import{_ as z}from"./vue-img-cutter-7be274e5.js";import{T as be}from"./TitleHeader-f4057bc5.js";import"./pinia-6f3a18e1.js";import"./vue-demi-71ba0ef2.js";import"./pinia-plugin-persistedstate-4f3b1591.js";import"./axios-760d4776.js";import"./nprogress-93825526.js";import"./artplayer-dacbf558.js";import"./pubsub-js-4eb33f76.js";/* empty css               */import"./vueuc-f6692277.js";import"./evtd-b614532e.js";import"./seemly-d1bbd19f.js";import"./@css-render-39cdbd82.js";import"./vooks-13ee1ac7.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-c742445b.js";import"./treemate-25c27bff.js";import"./date-fns-975a2d8f.js";const Pe=["title","onClick"],Ie=["onClick"],Le=M({__name:"SongSortCard",props:{song:null},setup(c){const r=c,b=W(),a=Y();function k(){a.push(`/song/${r.song.id}`)}function v(){a.push(`/artist/${r.song.artists[0].id}`)}function o(){const{song:d}=r;b.setPlayingSong({album:d.album,artists:d.artists,id:d.id,name:d.name,isVip:d.privilege.freeTrialPrivilege.resConsumable})}return(d,S)=>{const f=Z,m=q;return i(),_("div",{class:"song-sort-card",onDblclick:o},[t("div",null,[e(f,{style:{"max-width":"240px"},tooltip:!1},{default:p(()=>[t("span",{title:c.song.name,class:"song-name text",onClick:P(k,["stop"])},w(c.song.name),9,Pe)]),_:1}),C(" --- "),t("span",{onClick:P(v,["stop"]),class:"text"},w(c.song.artists[0].name),9,Ie)]),e(m,{size:"15",title:"播放 "+c.song.name,onClick:P(o,["stop"])},{default:p(()=>[e(I(ye))]),_:1},8,["title","onClick"])],32)}}});const Te=z(Le,[["__scopeId","data-v-49fc2be7"]]),Ve={class:"page-skeleton"},Me={class:"song-infor"},ze={class:"cover-skeleton"},Be={class:"song-data"},Ne={class:"song-list"},Ue={class:"music-list"},je=M({__name:"SongSkeleton",setup(c){return(r,b)=>{const a=xe;return i(),_("div",Ve,[t("div",Me,[t("div",ze,[e(a,{style:{"border-radius":"10px",height:"100%",width:"100%"}})]),t("div",Be,[e(a,{style:{height:"20px","margin-bottom":"5px"}}),e(a,{style:{height:"20px","margin-bottom":"5px"}}),e(a,{style:{height:"20px","margin-bottom":"5px"}}),e(a,{style:{height:"20px","margin-bottom":"5px",width:"60%"}}),e(a,{style:{height:"20px","margin-bottom":"5px",width:"60%"}}),e(a,{style:{height:"20px","margin-bottom":"5px",width:"60%"}})])]),t("div",Ne,[e(a,{style:{height:"20px",margin:"10px",width:"30%"}}),t("div",Ue,[e(ne,{coverRadius:10,"text-center":!1,length:3})])])])}}});const Ee=z(je,[["__scopeId","data-v-7c7661ed"]]),B=c=>(_e("data-v-03b77c02"),c=c(),pe(),c),Re={class:"page"},De={key:1,class:"song-infor"},Ae={class:"information"},He={class:"song-cover"},Fe={class:"song-data"},We=B(()=>t("span",null,"歌手: ",-1)),Ye=["onClick"],Ze=B(()=>t("span",{style:{"font-size":"13px"}},"专辑: ",-1)),qe={key:0,class:"simi-songs"},Ge=B(()=>t("span",null,"相似歌曲",-1)),Je={class:"song-func"},Ke={class:"simi-playlist music-list"},Oe={key:0},Qe=M({__name:"Song",setup(c){const r=ie(),b=W(),a=$(!1),k=he(),v=Y(),o=$(),d=$(),S=H([]),f=H([]),m=$(!1),L=$(!1);let N=!1;async function U(){L.value=!0;try{const s=await de(+k.params.id);s.code!==200&&Promise.reject(),o.value=s.songs[0],d.value=s.privileges[0];const l=await me(+k.params.id);l.code!==200&&Promise.reject(),l.songs.forEach(u=>{S.push(u)});const h=await ge(+k.params.id);h.code!==200&&Promise.reject(),h.playlists.forEach(u=>{f.push(u)}),m.value=r.userData.ids.some(u=>u===o.value.id),L.value=!1}catch{x("获取歌曲数据失败 🤔","warning"),v.replace("/404")}}function G(){r.cookie&&r.isLogin?a.value=!0:x("请先登陆 👀","info")}ce(U),ve(()=>{f.splice(0,f.length),S.splice(0,S.length)}),fe(()=>{N=!0}),ue(()=>k.params.id,()=>{N||U()});function J(){var s,l,h,u,g;b.setPlayingSong({album:(s=o.value)==null?void 0:s.al,artists:(l=o.value)==null?void 0:l.ar,id:(h=o.value)==null?void 0:h.id,name:(u=o.value)==null?void 0:u.name,isVip:(g=d.value)==null?void 0:g.freeTrialPrivilege.resConsumable})}function K(){var s;v.push(`/album/${(s=o.value)==null?void 0:s.al.id}`)}function O(){var s;v.push(`/song-comment/${(s=o.value)==null?void 0:s.id}?page=1`)}async function Q(){if(!r.isLogin&&!r.cookie)return x("请先登陆 👀","info");const s=o.value.id;try{m.value?((await A(s,!1)).code!==200&&Promise.reject(),m.value=!1,x("取消喜欢音乐成功 😃","success"),r.removeSongLike(s)):((await A(s,!0)).code!==200&&Promise.reject(),m.value=!0,x("喜欢音乐成功 😃","success"),r.setSongLikeList(s))}catch{x("喜欢/取消喜欢音乐失败 🙄","warning")}}function X(){var s;v.push(`/mv/${(s=o.value)==null?void 0:s.mv}`)}return(s,l)=>{var j,E,R,D;const h=Ce,u=Z,g=$e,ee=q,se=le,oe=re,te=we;return i(),_("div",Re,[L.value?(i(),y(Ee,{key:0})):(i(),_("div",De,[t("div",Ae,[t("div",He,[e(h,{src:(j=o.value)==null?void 0:j.al.picUrl},null,8,["src"])]),t("div",Fe,[t("h2",null,[e(u,{"line-clamp":2},{default:p(()=>{var n;return[C(w((n=o.value)==null?void 0:n.name),1)]}),_:1})]),t("div",null,[We,(i(!0),_(T,null,V((E=o.value)==null?void 0:E.ar,n=>(i(),_("span",{onClick:P(Xe=>I(v).push(`/artist/${n.id}`),["stop"]),class:"artist",key:n.id},w(n.name),9,Ye))),128))]),t("div",{onClick:K},[Ze,e(u,{style:{"max-width":"300px",position:"relative",top:"-.5px"},class:"text",textContent:w((R=o.value)==null?void 0:R.al.name)},null,8,["textContent"])]),S.length?(i(),_("div",qe,[Ge,(i(!0),_(T,null,V(S,n=>(i(),y(Te,{song:n,key:n.id},null,8,["song"]))),128))])):F("",!0),t("div",Je,[e(g,{onClick:J,size:"small",strong:"",secondary:"",type:"error"},{default:p(()=>[C("播放")]),_:1}),e(g,{style:{position:"relative",top:"3px"},onClick:Q,size:"small",strong:"",secondary:""},{default:p(()=>[e(ee,{color:m.value?"red":""},{default:p(()=>[m.value?(i(),y(I(ke),{key:0})):(i(),y(I(Se),{key:1}))]),_:1},8,["color"])]),_:1}),e(g,{onClick:G,size:"small",strong:"",secondary:""},{default:p(()=>[C("添加到")]),_:1}),e(g,{onClick:O,size:"small",strong:"",secondary:"",type:"info"},{default:p(()=>[C("评论")]),_:1}),(D=o.value)!=null&&D.mv?(i(),y(g,{key:0,onClick:X,size:"small",strong:"",secondary:"",type:"warning"},{default:p(()=>[C("MV")]),_:1})):F("",!0)])])]),t("div",Ke,[e(be,{title:"包含这首歌的歌单"}),f.length?(i(),_("ul",Oe,[(i(!0),_(T,null,V(f,n=>(i(),y(se,{key:n.id,"cover-img-url":n.coverImgUrl,id:n.id,name:n.name,"play-count":n.playCount},null,8,["cover-img-url","id","name","play-count"]))),128))])):(i(),y(oe,{key:1,description:"这首歌暂时没被收藏到热门歌单过呢 😉","show-btn":!1}))])])),e(te,{show:a.value,"onUpdate:show":l[1]||(l[1]=n=>a.value=n)},{default:p(()=>[e(ae,{render:!0,"song-id":o.value.id,onCloseBox:l[0]||(l[0]=n=>a.value=!1)},null,8,["song-id"])]),_:1},8,["show"])])}}});const Is=z(Qe,[["__scopeId","data-v-03b77c02"]]);export{Is as default};
