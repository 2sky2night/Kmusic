import{d as I,o as l,c as _,a as r,V as n,r as k,g as z,x as Z,a0 as q,S as C,U as b,a4 as W,I as D,w as P,F as N,a3 as R,W as $,$ as y,e as j,a1 as S,Y as J,Z as K,y as F,v as T}from"./@vue-923429e4.js";import{C as X,s as ee,a as H}from"./CommentCell-0c6c6eee.js";import{v as te,N as se,d as Q,Q as ne,R as oe,f as ae,F as re}from"./naive-ui-809e5fbb.js";import{_ as L}from"./vue-img-cutter-7be274e5.js";import{r as V,p as E,a as v,c as ie,u as le,o as ce,i as ue}from"./index-1f548d76.js";import{u as Y,a as me}from"./vue-router-70c59f8f.js";import{A as de}from"./artplayer-dacbf558.js";import{Y as pe,Z as _e,f as ve}from"./@vicons-ed1f5506.js";import{T as he}from"./TitleHeader-f4057bc5.js";import{P as fe}from"./pubsub-js-4eb33f76.js";import"./vueuc-f6692277.js";import"./evtd-b614532e.js";import"./seemly-d1bbd19f.js";import"./@css-render-39cdbd82.js";import"./vooks-13ee1ac7.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-c742445b.js";import"./treemate-25c27bff.js";import"./date-fns-975a2d8f.js";import"./pinia-6f3a18e1.js";import"./vue-demi-71ba0ef2.js";import"./pinia-plugin-persistedstate-4f3b1591.js";import"./axios-760d4776.js";import"./nprogress-93825526.js";/* empty css               */const ge={class:"mv-page-skeleton"},ye={class:"mv-list"},xe=I({__name:"MvSkeleton",setup(t){return(i,a)=>{const e=te;return l(),_("div",ge,[r("div",null,[n(e,{height:"400px",width:"98%",style:{"border-radius":"10px"}}),n(e,{height:"30px",style:{margin:"5px 0"},width:"40%"}),n(e,{height:"30px",style:{margin:"5px 0"},width:"30%"}),n(e,{height:"30px",style:{margin:"5px 0"},width:"30%"}),n(X)]),r("ul",ye,[n(e,{height:"100px",style:{margin:"10px 5px"}}),n(e,{height:"100px",style:{margin:"10px 5px"}}),n(e,{height:"100px",style:{margin:"10px 5px"}}),n(e,{height:"100px",style:{margin:"10px 5px"}}),n(e,{height:"100px",style:{margin:"10px 5px"}})])])}}});const we=L(xe,[["__scopeId","data-v-7c345d3f"]]),ke=t=>V.get("/mv/detail",{params:{mvid:t}}),$e=t=>V.get("/simi/mv",{params:{mvid:t}}),G=(t,i,a=20)=>V.get("/comment/mv",{params:{id:t,offset:(i-1)*a,limit:a}}),be=(t,i)=>V.get("/mv/url",{params:{id:t,r:i}}),O=(t,i)=>V.get("/mv/sub",{params:{mvid:t,t:i}}),Ie=I({__name:"Video",props:{option:null},emits:["get-instance"],setup(t,{emit:i}){const a=t;let e=null;const o=k(null);return z(()=>{e=new de({...a.option,container:o.value,autoMini:!0,setting:!0,flip:!0,playbackRate:!0,aspectRatio:!0,fullscreen:!0,theme:"#4098fc",lock:!0,hotkey:!0}),Z(()=>{i("get-instance",e)})}),q(()=>{e&&e.destroy&&e.destroy(!1)}),(c,u)=>(l(),_("div",{ref_key:"artRef",ref:o,class:"video-area"},null,512))}});const Ce={class:"artsit-item"},Me=["src"],Se=["onClick"],De=I({__name:"ArtistItem",props:{id:null,name:null,url:null},setup(t){const i=t,a=Y();function e(){a.push(`/artist/${i.id}`)}return(o,c)=>(l(),_("li",Ce,[t.url?(l(),_("img",{key:0,src:t.url},null,8,Me)):C("",!0),r("span",{class:"text",onClick:W(e,["stop"])},b(t.name),9,Se)]))}});const Pe=L(De,[["__scopeId","data-v-cf673f6d"]]),Le={key:0,class:"mv-infor"},Ve={class:"video-box"},Ne={class:"infor"},Re={class:"artist-list"},je={class:"mv-data"},ze={key:0,class:"desc"},Ue=I({__name:"MvInfor",props:{id:null},emits:["loadDone"],setup(t,{emit:i}){const a=t,e=Y(),o=k(),c=k(!1),u=D([]),x=k(!0),p=D({url:"",poster:"",title:"",settings:[]});let h=null;async function M(){x.value=!0;const s=a.id;try{const m=await ke(s);m.code!==200&&await Promise.reject(),o.value=m.data,c.value=m.subed,m.data.brs.forEach(d=>{u.push({br:d.br,url:"",size:d.size})});for(let d=0;d<u.length;d++){const f=await be(s,u[d].br);f.code!==200&&await Promise.reject(),u[d].url=f.data.url}p.poster=o.value.cover,p.title=o.value.name,p.url=u[u.length-1].url;const w=u.map((d,f,B)=>{const g=Math.round(d.size/1048576);return{default:f===B.length-1,html:`${d.br+"P"}`,url:d.url,size:g}});p.settings.push({html:"分辨率",width:150,tooltip:w[w.length-1].html,selector:w,onSelect:function(d){return v(`当前播放的视频大小为 ${d.size}Mb 😀`,"info"),h.switchQuality(d.url,d.html),d.html}}),x.value=!1,i("loadDone")}catch{v("获取mv数据失败 😴","error"),e.replace("/404")}}async function U(){const{id:s}=a;try{c.value?((await O(s,0)).code===200?v("取消收藏mv成功 🤩","success"):await Promise.reject(),c.value=!1):((await O(s,1)).code===200?v("收藏mv成功 🤩","success"):await Promise.reject(),c.value=!0)}catch{v("收藏/取消收藏mv失败 😂","warning")}}function A(s){h=s}return z(M),P(()=>a.id,()=>{x.value=!0,u.splice(0,u.length),M()}),(s,m)=>{const w=se,d=Q;return x.value?C("",!0):(l(),_("div",Le,[r("div",Ve,[n(Ie,{onGetInstance:A,option:p},null,8,["option"])]),r("div",Ne,[r("h1",null,b(o.value.name),1),r("ul",Re,[(l(!0),_(N,null,R(o.value.artists,f=>(l(),S(Pe,{key:f.id,id:f.id,name:f.name,url:f.img1v1Url},null,8,["id","name","url"]))),128))]),r("div",je,[r("div",null,[n(w,{style:{position:"relative",top:"2px"}},{default:$(()=>[n(y(pe))]),_:1}),r("span",null,b(y(E)(o.value.playCount))+" 次播放",1)]),r("div",null,[n(w,{style:{position:"relative",top:"2px"}},{default:$(()=>[n(y(_e))]),_:1}),r("span",null,b(y(E)(o.value.shareCount))+" 次分享",1)]),r("div",null,[n(w,{style:{position:"relative",top:"2px"}},{default:$(()=>[n(y(ve))]),_:1}),r("span",null,b(y(E)(o.value.commentCount))+" 条评论",1)]),n(d,{onClick:U,strong:"",secondary:"",type:c.value?"warning":"default",size:"small"},{default:$(()=>[j(b(c.value?"已收藏":"收藏"),1)]),_:1},8,["type"])]),o.value.desc?(l(),_("div",ze," 简介: "+b(o.value.desc),1)):C("",!0)])]))}}});const Ae={key:0,class:"simi-mv"},Be=I({__name:"SimiMv",props:{id:null},emits:["loadDone"],setup(t,{emit:i}){const a=t,e=D([]);z(o);async function o(){try{const c=await $e(a.id);c.code!==200&&await Promise.reject(),c.mvs.forEach(u=>{e.push(u)}),i("loadDone")}catch{v("获取相似的mv失败 😪","error")}}return P(()=>a.id,()=>{e.splice(0,e.length),o()}),(c,u)=>{const x=ne;return e.length?(l(),_("div",Ae,[n(x,{prefix:"bar","align-text":""},{default:$(()=>[j(" 相似的mv ")]),_:1}),r("ul",null,[(l(!0),_(N,null,R(e,p=>(l(),S(ie,{style:{"margin-bottom":"10px"},key:p.id,"cover-url":p.cover,durationms:p.duration,"play-time":p.playCount,vid:p.id+"",title:p.name,creators:p.artists.map(h=>({userId:h.id,userName:h.name}))},null,8,["cover-url","durationms","play-time","vid","title","creators"]))),128))])])):C("",!0)}}});const Ee=L(Be,[["__scopeId","data-v-a5e6353e"]]),Fe=t=>(J("data-v-4b98d649"),t=t(),K(),t),Te={class:"comment-area"},He={key:0,class:"hot-comments"},Ge={class:"my-comment-area"},Oe={key:1,class:"comments"},Qe=Fe(()=>r("span",null,"全部评论",-1)),Ye={style:{"font-size":"12px","margin-left":"5px"}},Ze={key:0,class:"pagination"},qe=I({__name:"Comment",props:{id:null},emits:["loadDone"],setup(t,{emit:i}){const a=t,e=le(),o=D([]),c=D([]),u=k(1),x=k(0),p=k(0),h=k("");z(M);async function M(){try{const s=await G(a.id,u.value);s.code!==200&&await Promise.reject(),s.hotComments.forEach(m=>{c.push(m)}),s.comments.forEach(m=>{o.push(m)}),p.value=s.total,x.value=ce(20,s.total),i("loadDone")}catch{v("获取mv评论失败 😴","error")}}async function U(){fe.publish("to-top"),o.splice(0,o.length);try{const s=await G(a.id,u.value);s.code!==200&&await Promise.reject(),s.comments.forEach(m=>{o.push(m)})}catch{v("获取mv评论失败 😴","error")}}P(u,U);async function A(){if(!e.isLogin&&!e.cookie)return v("登录后再进行该操作吧~ 😉","info");if(!h.value)return v("输入内容不能为空 😉","warning");try{const s=await ee(a.id,1,1,h.value);s.code!==200?Promise.reject(s.message):v("评论成功 😋","success"),o.unshift({beReplied:[],commentId:s.comment.commentId,content:s.comment.content,ipLocation:{ip:null,location:"未知",userId:s.comment.user.userId},user:s.comment.user,timeStr:"刚刚",time:s.comment.time,status:0,parentCommentId:0,owner:!0,likedCount:0,liked:!1}),h.value=""}catch(s){v(s.response.data.msg,"error")}}return P(()=>a.id,()=>{c.splice(0,c.length),o.splice(0,o.length),M()}),(s,m)=>{const w=oe,d=Q,f=ae,B=re;return l(),_("div",Te,[u.value===1&&c.length?(l(),_("div",He,[n(w,{prefix:"bar",style:{margin:"10px 0"}},{default:$(()=>[j(" 热门评论 ")]),_:1}),r("ul",null,[(l(!0),_(N,null,R(c,g=>(l(),S(H,{key:g.commentId,comment:g,id:t.id,type:1,"user-id":y(e).userData.id},null,8,["comment","id","user-id"]))),128))])])):C("",!0),r("div",Ge,[n(he,{title:"发送评论"}),r("div",null,[n(f,{clearable:"",value:h.value,"onUpdate:value":m[0]||(m[0]=g=>h.value=g),valueModifiers:{trim:!0},type:"textarea",placeholder:"输入评论吧~"},{suffix:$(()=>[n(d,{strong:"",secondary:"",type:"info",onClick:A},{default:$(()=>[j("发送")]),_:1})]),_:1},8,["value"])])]),o.length?(l(),_("div",Oe,[r("div",null,[n(w,{prefix:"bar",style:{margin:"10px 0"}},{default:$(()=>[Qe]),_:1}),r("span",Ye,"总共"+b(p.value)+" 条",1)]),r("ul",null,[(l(!0),_(N,null,R(o,g=>(l(),S(H,{key:g.commentId,comment:g,id:t.id,type:1,"user-id":y(e).userData.id},null,8,["comment","id","user-id"]))),128))]),x.value>1?(l(),_("div",Ze,[n(B,{size:"small",page:u.value,"onUpdate:page":m[1]||(m[1]=g=>u.value=g),"page-slot":5,"page-count":x.value},null,8,["page","page-count"])])):C("",!0)])):(l(),S(ue,{key:2,"show-btn":!1,description:"还没有人评论呢,快来抢沙发吧! 😎"}))])}}});const We=L(qe,[["__scopeId","data-v-4b98d649"]]),Je={class:"page"},Ke={class:"mv-box"},Xe={class:"mv-container"},et=I({__name:"MV",setup(t){const i=k(0),a=me();function e(){i.value++}return P(()=>a.params,()=>{i.value=0}),(o,c)=>(l(),_("div",Je,[F(r("div",Ke,[r("div",Xe,[n(Ue,{id:+y(a).params.id,onLoadDone:e},null,8,["id"]),n(We,{id:+y(a).params.id,onLoadDone:e},null,8,["id"])]),n(Ee,{id:+y(a).params.id,onLoadDone:e},null,8,["id"])],512),[[T,i.value===3]]),F(n(we,null,null,512),[[T,i.value!==3]])]))}});const Dt=L(et,[["__scopeId","data-v-e3330330"]]);export{Dt as default};
